---
title: "DA2/C2 - Term Project"
author: "Son Nam Nguyen"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F, fig.asp = 0.5, fig.width = 7, out.width = "90%" )
```

## Setup

```{r cars}

#setwd("~/Desktop/repos/c2-nyse-term-project")

# Loading packages with pacman
if (!require("pacman")) {
  install.packages("pacman")
}

pacman::p_load(tidyverse, modelsummary, kableExtra, fixest, estimatr, mfx, data.table)

df <- read.table("stack-overflow-developer-survey-2021/survey_results.gz", header = TRUE, sep=",", quote = "\"", fill=TRUE)

```
## Introduction

This is a causal analysis on fourth graders in Massachusetts public schools in the spring of 1998. We investigating the effect of student per teacher ratio on the test results of the fourth graders. ECT.

HERE COMES THE MOTIVATION WHY THIS IS A MEANINGFUL PROJECT AND WHAT IS THE MAIN GOAL!

## Data

The Massachusetts data are ...
Further information is available (here)[<https://www.rdocumentation.org/packages/AER/versions/1.2-9/topics/MASchools>].

ECT.

```{r dataclean}

df <- df %>% select( score4 , stratio, english, 
                     income, scratio, exptot, special,
                     lunch, salary ) %>% drop_na()

target <- c("Employment", "Country", "EdLevel", "YearsCode", "YearsCodePro", "DevType", "OrgSize", "LanguageHaveWorkedWith", "SOVisitFreq", "Age", "Gender", "ConvertedCompYearly")

df <- df[ ,which((names(df) %in% target)==TRUE)]

#Data cleaning
df <- df %>%
      mutate(
        CompSize = ifelse(OrgSize %in% c("Just me - I am a freelancer, sole proprietor, etc.", "10 to 19 employees", "2 to 9 employees"), "small", 
                          ifelse(OrgSize %in% c("20 to 99 employees","500 to 999 employees", "1,000 to 4,999 employees"), "medium", 
                                 ifelse(OrgSize %in% c("1,000 to 4,999 employees", "5,000 to 9,999 employees", "10,000 or more employees"), "large", NA))),
        YearsCode = as.numeric(YearsCode),
        YearsCodePro = as.numeric(YearsCodePro), 
        ConvertedCompYearly = as.numeric(ConvertedCompYearly),
        Python = c(0, 1)[1+grepl("Python", as.character(LanguageHaveWorkedWith))],
        SQL = c(0, 1)[1+grepl("SQL", as.character(LanguageHaveWorkedWith))],
        R = c(0, 1)[1+grepl("R", as.character(LanguageHaveWorkedWith))],
        Julia = c(0, 1)[1+grepl("Julia", as.character(LanguageHaveWorkedWith))],
        )

```


```{r summary}

P95 <- function(x){quantile(x,0.95,na.rm=T)}
P05 <- function(x){quantile(x,0.05,na.rm=T)}
datasummary( (`Overall Grade` = score4 ) + 
             (`Student to teacher ratio` = stratio ) + 
             (`Percent of english learner` = english ) + 
             (`Income per capita` = income) + 
             (`Student to computer ratio` = scratio) + 
             (`Total Expenditure ($)` = exptot) + 
             (`Special education students (%)` = special )+
             (`Percent qualifying for reduced-price lunch` = lunch ) +
             (`Average teacher hourly wage ($)` = salary ) ~
             Mean + Median + SD + Min + Max + P05 + P95 , 
             data = df ,
             title = 'Descriptive statistics') %>% 
      kable_styling(latex_options = c("HOLD_position","scale_down"))

```


DESCRIPTION OF THE SUMMARY STATS: WHAT CAN WE LEARN FROM THEM?

```{r distributions}

```

DESCRIPTION OF THE FIGURE. WHAT DOES IT TELS US?

Pattern of association

```{r scatter}

```

How will you include this in your model?

Short description on the other variables: 2-10 sentence depends on the amount of variables you have. You should reference your decisions on the graphs/analysis which are located in the appendix.

## Model

```{r models}

```

My preferred model is:
HERE YOU INTERPRET YOUR RESULTS AND COMPARE MODELS


## Robustness check / 'Heterogeneity analysis'

Task: calculate and report t-tests for each countries. 

```{r robust}
```

## Conclusion

HERE COMES WHAT WE HAVE LEARNED AND WHAT WOULD STRENGHTEN AND WEAKEN OUR ANALYSIS.

## Appendix

Here comes all the results which are referenced and not essential for understanding the MAIN results.